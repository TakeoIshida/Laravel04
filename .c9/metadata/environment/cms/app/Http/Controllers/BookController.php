{"filter":false,"title":"BookController.php","tooltip":"/cms/app/Http/Controllers/BookController.php","undoManager":{"mark":32,"position":32,"stack":[[{"start":{"row":16,"column":9},"end":{"row":16,"column":10},"action":"remove","lines":["/"],"id":2},{"start":{"row":16,"column":8},"end":{"row":16,"column":9},"action":"remove","lines":["/"]}],[{"start":{"row":16,"column":8},"end":{"row":16,"column":34},"action":"insert","lines":["return view('books'); //追記"],"id":3}],[{"start":{"row":5,"column":28},"end":{"row":6,"column":0},"action":"insert","lines":["",""],"id":4}],[{"start":{"row":6,"column":0},"end":{"row":6,"column":14},"action":"insert","lines":["use Validator;"],"id":5}],[{"start":{"row":38,"column":9},"end":{"row":38,"column":10},"action":"remove","lines":["/"],"id":6},{"start":{"row":38,"column":8},"end":{"row":38,"column":9},"action":"remove","lines":["/"]}],[{"start":{"row":38,"column":8},"end":{"row":61,"column":24},"action":"insert","lines":["   //バリデーション","    $validator = Validator::make($request->all(), [","         'item_name' => 'required|min:3|max:255',","         'item_number' => 'required | min:1 | max:3',","         'item_amount' => 'required | max:6',","         'published'   => 'required',","    ]);","","    //バリデーション:エラー ","    if ($validator->fails()) {","        return redirect('/')","            ->withInput()","            ->withErrors($validator);","    }","","    //以下に登録処理を記述（Eloquentモデル）","\t  // Eloquentモデル","\t  $books = new Book;","\t  $books->item_name   = $request->item_name;","\t  $books->item_number = $request->item_number;","\t  $books->item_amount = $request->item_amount;","\t  $books->published   = $request->published;","\t  $books->save(); ","\t  return redirect('/');"],"id":7}],[{"start":{"row":16,"column":5},"end":{"row":17,"column":0},"action":"insert","lines":["",""],"id":8},{"start":{"row":17,"column":0},"end":{"row":17,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":17,"column":8},"end":{"row":19,"column":0},"action":"insert","lines":["//本の全件データ取得","    $books = Book::orderBy('created_at', 'asc')->get();",""],"id":9}],[{"start":{"row":18,"column":4},"end":{"row":18,"column":8},"action":"insert","lines":["    "],"id":10}],[{"start":{"row":18,"column":59},"end":{"row":19,"column":0},"action":"remove","lines":["",""],"id":11}],[{"start":{"row":19,"column":8},"end":{"row":19,"column":34},"action":"remove","lines":["return view('books'); //追記"],"id":12}],[{"start":{"row":19,"column":8},"end":{"row":19,"column":50},"action":"insert","lines":["return view('books', ['books' => $books]);"],"id":13}],[{"start":{"row":108,"column":9},"end":{"row":108,"column":10},"action":"remove","lines":["/"],"id":14},{"start":{"row":108,"column":8},"end":{"row":108,"column":9},"action":"remove","lines":["/"]}],[{"start":{"row":108,"column":8},"end":{"row":109,"column":31},"action":"insert","lines":["$book->delete();       //追加","    return redirect('/');  //追加"],"id":15}],[{"start":{"row":109,"column":4},"end":{"row":109,"column":8},"action":"insert","lines":["    "],"id":16}],[{"start":{"row":85,"column":9},"end":{"row":85,"column":10},"action":"remove","lines":["/"],"id":17},{"start":{"row":85,"column":8},"end":{"row":85,"column":9},"action":"remove","lines":["/"]}],[{"start":{"row":85,"column":8},"end":{"row":86,"column":52},"action":"insert","lines":["//{books}id 値を取得 => Book $books id 値の1レコード取得","        return view('booksedit', ['book' => $book]);"],"id":18}],[{"start":{"row":98,"column":9},"end":{"row":98,"column":10},"action":"remove","lines":["/"],"id":19},{"start":{"row":98,"column":8},"end":{"row":98,"column":9},"action":"remove","lines":["/"]}],[{"start":{"row":98,"column":8},"end":{"row":120,"column":29},"action":"insert","lines":["//バリデーション","         $validator = Validator::make($request->all(), [","             'id' => 'required',","             'item_name' => 'required|min:3|max:255',","             'item_number' => 'required|min:1|max:3',","             'item_amount' => 'required|max:6',","             'published' => 'required',","        ]);","        //バリデーション:エラー","         if ($validator->fails()) {","             return redirect('/booksedit/'.$request->id)","                 ->withInput()","                 ->withErrors($validator);","        }","        ","        //データ更新","        $books = Book::find($request->id);","        $books->item_name   = $request->item_name;","        $books->item_number = $request->item_number;","        $books->item_amount = $request->item_amount;","        $books->published   = $request->published;","        $books->save();","        return redirect('/');"],"id":20}],[{"start":{"row":18,"column":8},"end":{"row":19,"column":50},"action":"remove","lines":["$books = Book::orderBy('created_at', 'asc')->get();","        return view('books', ['books' => $books]);"],"id":21}],[{"start":{"row":18,"column":8},"end":{"row":21,"column":11},"action":"insert","lines":["$books = Book::orderBy('created_at', 'asc')->paginate(3);","        return view('books', [","            'books' => $books","        ]);"],"id":22}],[{"start":{"row":17,"column":8},"end":{"row":21,"column":11},"action":"remove","lines":["//本の全件データ取得","        $books = Book::orderBy('created_at', 'asc')->paginate(3);","        return view('books', [","            'books' => $books","        ]);"],"id":25}],[{"start":{"row":17,"column":8},"end":{"row":21,"column":11},"action":"insert","lines":["//自分のuser_idが付与されている投稿だけ取得する","        $books = Book::where('user_id',Auth::id())->orderBy('created_at', 'asc')->paginate(3);","        return view('books', [","            'books' => $books","        ]);"],"id":26}],[{"start":{"row":42,"column":5},"end":{"row":65,"column":24},"action":"remove","lines":["      //バリデーション","    $validator = Validator::make($request->all(), [","         'item_name' => 'required|min:3|max:255',","         'item_number' => 'required | min:1 | max:3',","         'item_amount' => 'required | max:6',","         'published'   => 'required',","    ]);","","    //バリデーション:エラー ","    if ($validator->fails()) {","        return redirect('/')","            ->withInput()","            ->withErrors($validator);","    }","","    //以下に登録処理を記述（Eloquentモデル）","\t  // Eloquentモデル","\t  $books = new Book;","\t  $books->item_name   = $request->item_name;","\t  $books->item_number = $request->item_number;","\t  $books->item_amount = $request->item_amount;","\t  $books->published   = $request->published;","\t  $books->save(); ","\t  return redirect('/');"],"id":27}],[{"start":{"row":42,"column":5},"end":{"row":66,"column":24},"action":"insert","lines":["//バリデーション","    $validator = Validator::make($request->all(), [","         'item_name' => 'required|min:3|max:255',","         'item_number' => 'required | min:1 | max:3',","         'item_amount' => 'required | max:6',","         'published'   => 'required',","    ]);","","    //バリデーション:エラー ","    if ($validator->fails()) {","        return redirect('/')","            ->withInput()","            ->withErrors($validator);","    }","","    //以下に登録処理を記述（Eloquentモデル）","\t  // Eloquentモデル","\t  $books = new Book;","\t  $books->item_name   = $request->item_name;","\t  $books->item_number = $request->item_number;","\t  $books->item_amount = $request->item_amount;","\t  $books->published   = $request->published;","\t\t$books->user_id = Auth::id();//ここを追加","\t  $books->save(); ","\t  return redirect('/');"],"id":28}],[{"start":{"row":42,"column":0},"end":{"row":42,"column":4},"action":"insert","lines":["    "],"id":29},{"start":{"row":43,"column":0},"end":{"row":43,"column":4},"action":"insert","lines":["    "]},{"start":{"row":44,"column":0},"end":{"row":44,"column":4},"action":"insert","lines":["    "]},{"start":{"row":45,"column":0},"end":{"row":45,"column":4},"action":"insert","lines":["    "]},{"start":{"row":46,"column":0},"end":{"row":46,"column":4},"action":"insert","lines":["    "]},{"start":{"row":47,"column":0},"end":{"row":47,"column":4},"action":"insert","lines":["    "]},{"start":{"row":48,"column":0},"end":{"row":48,"column":4},"action":"insert","lines":["    "]},{"start":{"row":49,"column":0},"end":{"row":49,"column":4},"action":"insert","lines":["    "]},{"start":{"row":50,"column":0},"end":{"row":50,"column":4},"action":"insert","lines":["    "]},{"start":{"row":51,"column":0},"end":{"row":51,"column":4},"action":"insert","lines":["    "]},{"start":{"row":52,"column":0},"end":{"row":52,"column":4},"action":"insert","lines":["    "]},{"start":{"row":53,"column":0},"end":{"row":53,"column":4},"action":"insert","lines":["    "]},{"start":{"row":54,"column":0},"end":{"row":54,"column":4},"action":"insert","lines":["    "]},{"start":{"row":55,"column":0},"end":{"row":55,"column":4},"action":"insert","lines":["    "]},{"start":{"row":56,"column":0},"end":{"row":56,"column":4},"action":"insert","lines":["    "]},{"start":{"row":57,"column":0},"end":{"row":57,"column":4},"action":"insert","lines":["    "]},{"start":{"row":58,"column":0},"end":{"row":58,"column":4},"action":"insert","lines":["    "]},{"start":{"row":59,"column":0},"end":{"row":59,"column":4},"action":"insert","lines":["    "]},{"start":{"row":60,"column":0},"end":{"row":60,"column":4},"action":"insert","lines":["    "]},{"start":{"row":61,"column":0},"end":{"row":61,"column":4},"action":"insert","lines":["    "]},{"start":{"row":62,"column":0},"end":{"row":62,"column":4},"action":"insert","lines":["    "]},{"start":{"row":63,"column":0},"end":{"row":63,"column":4},"action":"insert","lines":["    "]},{"start":{"row":64,"column":0},"end":{"row":64,"column":4},"action":"insert","lines":["    "]},{"start":{"row":65,"column":0},"end":{"row":65,"column":4},"action":"insert","lines":["    "]},{"start":{"row":66,"column":0},"end":{"row":66,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":64,"column":5},"end":{"row":64,"column":6},"action":"remove","lines":["\t"],"id":30}],[{"start":{"row":64,"column":5},"end":{"row":64,"column":9},"action":"insert","lines":["    "],"id":31}],[{"start":{"row":64,"column":8},"end":{"row":64,"column":9},"action":"remove","lines":[" "],"id":32},{"start":{"row":64,"column":7},"end":{"row":64,"column":8},"action":"remove","lines":[" "]}],[{"start":{"row":101,"column":8},"end":{"row":123,"column":29},"action":"remove","lines":["//バリデーション","         $validator = Validator::make($request->all(), [","             'id' => 'required',","             'item_name' => 'required|min:3|max:255',","             'item_number' => 'required|min:1|max:3',","             'item_amount' => 'required|max:6',","             'published' => 'required',","        ]);","        //バリデーション:エラー","         if ($validator->fails()) {","             return redirect('/booksedit/'.$request->id)","                 ->withInput()","                 ->withErrors($validator);","        }","        ","        //データ更新","        $books = Book::find($request->id);","        $books->item_name   = $request->item_name;","        $books->item_number = $request->item_number;","        $books->item_amount = $request->item_amount;","        $books->published   = $request->published;","        $books->save();","        return redirect('/');"],"id":33}],[{"start":{"row":101,"column":8},"end":{"row":123,"column":29},"action":"insert","lines":["//バリデーション","         $validator = Validator::make($request->all(), [","             'id' => 'required',","             'item_name' => 'required|min:3|max:255',","             'item_number' => 'required|min:1|max:3',","             'item_amount' => 'required|max:6',","             'published' => 'required',","        ]);","        //バリデーション:エラー","         if ($validator->fails()) {","             return redirect('/booksedit/'.$request->id)","                 ->withInput()","                 ->withErrors($validator);","        }","        ","        //データ更新","        $books = Book::where('user_id',Auth::id())->find($request->id);","        $books->item_name   = $request->item_name;","        $books->item_number = $request->item_number;","        $books->item_amount = $request->item_amount;","        $books->published   = $request->published;","        $books->save();","        return redirect('/');"],"id":34}],[{"start":{"row":7,"column":0},"end":{"row":7,"column":9},"action":"insert","lines":["use Auth;"],"id":35}],[{"start":{"row":7,"column":9},"end":{"row":8,"column":0},"action":"insert","lines":["",""],"id":36},{"start":{"row":8,"column":0},"end":{"row":9,"column":0},"action":"insert","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":1413.6000000000017,"scrollleft":32.399999999999984,"selection":{"start":{"row":7,"column":9},"end":{"row":7,"column":9},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":72,"state":"php-doc-start","mode":"ace/mode/php"}},"timestamp":1675498362914,"hash":"d9cc17fd08408c1142c1dfe769bfae7af248e1cd"}